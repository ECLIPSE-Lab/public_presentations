---
title: |
  Data Science for Electron Microscopy<br>
  Lecture 8: Imaging Inverse Problems 1
bibliography: ref.bib
csl: custom.csl
author:
  - name: Philipp Pelz
    affiliation: 
      - FAU Erlangen-Nürnberg
execute: 
  eval: true
  echo: true
format:
    revealjs: 
        code-copy: true
        # scroll-view:
        #     activate: true
        #     snap: mandatory
        #     layout: full
        width: 1920
        height: 1080
        menu:
            side: right  
            width: wide 
        template-partials:
            - title-slide.html
        css: custom.css  
        theme: custom.scss 
        slide-number: c/t    
        logo: "eclipse_logo_small.png"  
        highlight-style: a11y 
        incremental: false   
        background-transition: fade  
        footer: "©Philipp Pelz - FAU Erlangen-Nürnberg - Data Science for Electron Microscopy"
---     
## What is Computational Imaging?

::: {.columns}
:::: {.column width="30%"}

![optics](img/figure-054.jpg)

::::
:::: {.column width="5%"}
<br><br><br>
![](img/figure-058.png)
::::
:::: {.column width="30%"}
![sensing](img/figure-055.jpg)
::::
:::: {.column width="5%"}
<br><br><br>
![](img/figure-058.png)
::::
:::: {.column width="30%"}
![computation](img/figure-056.png)
::::
:::

## What is Computational Imaging in Electron Microscopy?

::: {.columns}
:::: {.column width="65%"}

![optics + sensors](img/optics_and_sensors.jpg){height=850px}

::::
 
:::: {.column width="5%"}
<br><br><br>
![](img/figure-058.png)
::::
:::: {.column width="30%"}
![computation](img/figure-056.png)

- Optically encode sample information on the detector
- Computationally reconstruct the sample information from the detector data
- Model the image formation as an inverse problem
::::
:::

## Roadmap

- What **is** an inverse problem?    
- Formal problem statement  
- Why inverse problems are hard  
- Signal models & priors

::: notes
Briefly walk the audience through the agenda (≤ 30 s).
:::

---

## What is an Inverse Problem?

- Unknown **signal** $x$  
- Known **forward model** $H$  
- Measured **data** $y = H(x) + e$  
- **Goal:** reconstruct $x$ as accurately as possible

![](img/inverse_problem.png){height=300px}  

### What makes imaging inverse problems challenging?

- solution is not unique
- data is noisy (measurement & model noise)
- problem is intractable
- data is very high-dimensional



::: {.callout-tip}
## The vast majority of imaging problems can be formulated as inverse problems.

:::

## Example forward models

| Imaging Problem                      | Radiation Type         | Forward Model / Measurement / Model Equation         | Variations / Notes                                 |
|--------------------------------------|------------------------|-----------------------------------------------------|----------------------------------------------------|
| 2D or 3D tomography                  | coherent x-ray         | $y_i = R_{\theta_i} x$                              | parallel, cone beam                                |
| 3D deconvolution microscopy          | fluorescence           | $y = Hx$                                            | brightfield, confocal, light sheet                 |
| Structured illumination microscopy (SIM) | fluorescence       | $y_i = HW_i x$                                      | full 3D reconstruction; non-sinusoidal patterns    |
| Positron emission tomography (PET)   | gamma rays             | $y_i = H \theta_i x$                                | list mode with time-of-flight                      |
| Magnetic resonance imaging (MRI)     | radio frequency        | $y = SFx$                                           | uniform or nonuniform sampling in k-space; dynamic MRI: gated or nongated, retrospective registration |
| Optical diffraction tomography (ODT) | coherent light         | $y_{t,i} = S_t F W_i x$                             | holography or gating                               |
| Interferometry                       |                        | $y_i = W_i F x$                                     |                                                    |

---
 

## Why Is It Difficult?

### 1. Non‑uniqueness (Under‑sampling)

**Compressive sensing example:** \\(y = Ax\\) with \\(A \\in \\mathbb{R}^{m \\times n}, m < n\\)

- Multiple signals consistent with measurement
- If \\(Az = 0\\), then \\(x\\) and \\(x' = x + z\\) map to same \\(y\\)
- **Impossible** to distinguish without assumptions about \\(x\\)

## 2. Ill‑conditioning (Noise Amplification)

**Deconvolution example:** \\(y = Ax + e\\) (blurred + noisy image)

- Matrix \\(A\\) invertible but \\(A^{-1}\\) poorly conditioned
- Small noise \\(e\\) → huge reconstruction error
- Direct inversion amplifies measurement noise

![Deconvolution with a Gaussian kernel as an example of an ill-
conditioned inverse problem. The PSNR relative to the original image is
above each image. The linear operator (or matrix) A implements a con-
volution with a 7 × 7 Gaussian kernel. Top row: Applied to an image,
the operator yields a blurry image. The inverse A−1 deconvolves the blurry
image, and gives an image that is essentially perfect (56dB instead of ∞dB
is due working with floating point numbers). Middle row: The inverse
A−1 is poorly conditioned which we can see if we add a small amount of
Gaussian noise to the blurry image. Applied to the noisy measurement, the
inverse A−1 generates a very noisy image (6.3dB). Bottom row: If the
same amount of noise is added to the original image, it has a much smaller,
essentially invisible effect.](figures/fig_ill_conditioned.png)  

## 3. Non‑linearity & Unknown Parameters

- Forward model \\(f\\) may be non‑linear
- System parameters may be unknown/uncertain


## Signal Models – Turning the Tide

**Key insight:** Prior knowledge converts ill‑posed → well‑posed problems

### Why Signal Models Matter
 
**Recall compressive sensing:** \\(y = Ax\\) with \\(A \\in \\mathbb{R}^{m \\times n}, m < n\\)

- Without prior knowledge: **impossible** (multiple signals consistent)
- With prior knowledge: **possible** reconstruction

---

### Example: Linear Subspace Model

**Assumption:** \\(x \\in \\{x = Uc, c \\in \\mathbb{R}^d\\}\\) with \\(d \\leq m\\)

**Reconstruction algorithm:**
1. Estimate coefficients: \\(\\hat{c} = (AU)^\\dagger y\\)
2. Recover signal: \\(\\hat{x} = U\\hat{c}\\)

**Success condition:** \\(AU\\) has full column rank → unique solution

 

## Modern Signal Models

- **Sparse models** (wavelets, DCT)
- **Total Variation** regularization
- **Learned priors** (autoencoders, GANs, diffusion)

\\[
x \\approx G(z)
\\qquad\\text{or}\\qquad
R(x)\\;\\text{small}
\\]

---

## Key Takeaways

- Inverse problems recover **causes** from **effects**  
- Imaging examples span noise removal to full 3‑D reconstruction  
- Core challenges: under‑sampling, noise amplification, non‑linearity  
- **Signal models** (classical or learned) are essential


---

## Reference

Heckel, R. (2024). *Deep Learning for Computational Imaging*, Chapter 1.



## References 
::: {#refs}
:::



 






































<script>
document.getElementById("marimo-frame").onload = function() {
    try {
        let iframeDoc = document.getElementById("marimo-frame").contentWindow.document;
        let marimoBadge = iframeDoc.querySelector("div.fixed.bottom-0.right-0.z-50");
        if (marimoBadge) {
            marimoBadge.style.display = "none";
            console.log("Marimo badge hidden successfully.");
        } else {
            console.log("Badge not found.");
        }
    } catch (error) {
        console.warn("Unable to modify iframe content due to CORS restrictions.");
    }
};
</script>
</div>