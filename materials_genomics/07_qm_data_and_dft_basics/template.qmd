---
title: |
  Materials Genomics<br>
  Lecture 7: QM Data and DFT Basics
bibliography: ref.bib
# csl: custom.csl
author:
  - name: Prof. Dr. Philipp Pelz
    affiliation: 
      - FAU Erlangen-Nürnberg
      - Institute of Micro- and Nanostructure Research
   
execute: 
  eval: true
  echo: true
format: 
    revealjs: 
        chalkboard: true
        mermaid:
            theme: forest
        # mermaid-format: png
        # scroll-view:
        #     activate: true
        #     snap: mandatory
        #     layout: full 
        width: 1920
        height: 1080
        menu:
            side: right
            width: wide 
        template-partials:
            - title-slide.html
        css: custom.css
        theme: custom.scss
        slide-number: c/t    
        logo: "eclipse_logo_small.png"          
        highlight-style: a11y
        incremental: true 
        background-transition: fade
        footer: "©Philipp Pelz - FAU Erlangen-Nürnberg - Materials Genomics"
---
 

## Welcome

### Week 7 — Quantum Mechanical Data & DFT Basics

**Goals for today:**

- Understand what DFT (Density Functional Theory) actually computes  
- Learn about energies, forces, band structures, elastic constants  
- See why DFT is computationally expensive  
- Understand why ML surrogates are important in Materials Genomics  
- Outline a toy DFT exercise (e.g., Quantum ESPRESSO or Materials Project workflow)  

---

## Outline

1. Why quantum mechanics in Materials Genomics?  
2. DFT in a nutshell  
3. What DFT gives you (outputs)  
4. Why DFT is expensive  
5. ML surrogates for DFT  
6. Exercise: toy DFT calculation  
7. Summary  

---

## 1. Why Quantum Mechanics?

Materials properties ultimately come from:

- Electrons interacting with nuclei  
- Quantum mechanics of many-body systems  

We need **ab initio** methods to:

- Predict energies & stability  
- Understand bonding  
- Compute band structures and gaps  
- Calculate elastic tensors & phonons  

DFT is the workhorse that:

- Makes QM practical for thousands of materials  
- Feeds data into genomics workflows & ML models  

---

## 2. DFT in a Nutshell

Density Functional Theory (DFT):

- Reformulates many-electron quantum problem in terms of **electron density**  
- Uses Kohn–Sham equations to approximate true many-body problem  
- Trade exactness for tractable approximations (functionals)  

Key elements:

- Exchange–correlation functional (LDA, GGA, etc.)  
- Pseudopotentials / PAW datasets  
- Plane-wave or localized basis sets  

Goal:

- Get ground-state properties of a material from first principles  

---

## Conceptual DFT Workflow

1. Start with structure (lattice + atomic positions)  
2. Choose:
3. 
   - Exchange–correlation functional  
   - Pseudopotentials  
   - k-point mesh  
   - Energy cutoff  
4. Solve Kohn–Sham equations self-consistently  
5. Obtain:
   - Total energy  
   - Forces on atoms  
   - Stress tensor  
   - Electronic eigenvalues (bands)  

---

## 3. What DFT Gives You

DFT is a **property engine**. Major outputs used in Materials Genomics:

---

### 3.1 Total Energies

- Total ground-state energy \(E_{\text{tot}}\)  
- Used to compute:
  - Formation energies  
  - Relative stability of polymorphs  
  - Phase diagrams (via convex hulls)  

Genomics angle:
- Energies from DFT populate Materials Project, OQMD, AFLOW…  

---

### 3.2 Forces & Relaxed Structures

DFT gives:
- Forces on atoms  
- Stress tensor on the cell  

Used for:
- Structural relaxations (geometry optimization)  
- Molecular dynamics (ab initio MD)  
- Training ML interatomic potentials  

Relaxed DFT structures → more accurate:
- Energies  
- Bond lengths  
- Angles  

---

### 3.3 Band Structures & Density of States (DOS)

From Kohn–Sham eigenvalues:
- Band structure \(E_n(\mathbf{k})\)  
- Electronic DOS  

Used for:
- Band gaps  
- Effective masses  
- Metallic vs insulating behavior  
- Density-of-states features for ML  

Even though Kohn–Sham gaps underestimate true band gaps, they are widely used as descriptors and initial screening targets.

---

### 3.4 Elastic Constants & Mechanical Properties

From energy or stress response to small strains:
- Elastic tensor \(C_{ij}\)  
- Bulk modulus, shear modulus  
- Poisson ratio  

Uses:
- Mechanical stability criteria  
- Screening for stiff / ductile materials  
- Inputs to multiscale models  

These quantities are in many DFT databases as “derived properties”.

---

## Other Valuable Outputs

Optionally mention:
- Charge densities & Bader charges  
- Phonon spectra  
- Born effective charges  
- Piezoelectric coefficients  
- Dielectric tensors  

All are **quantum mechanical data** that can feed:
- Feature generation  
- Surrogate models  
- Design workflows  

---

## 4. Why DFT Is Expensive

DFT scales roughly:
- Between \(O(N^2)\) and \(O(N^3)\) with number of electrons / basis size  

Main cost drivers:
- System size (number of atoms)  
- k-point mesh density  
- Energy cutoff (basis size)  
- Type of functional (GGA vs hybrid)  

---

## Practical Consequences

- Typical DFT calculations:
  - 10–100 atoms per cell: feasible  
  - Hundreds of atoms: expensive  
  - Thousands: often impractical  

- Hybrid functionals / GW:
  - Even more expensive  
  - Only used for selected systems  

Therefore:
- DFT databases are limited in size & coverage  
- We cannot run DFT for every candidate material or structure  

This is where **ML surrogates** enter.

---

## 5. ML Surrogates for DFT

Goal:
- Approximate DFT outputs (energies, forces, bands…) with ML models  
- Trained on limited DFT data  
- Deployed to explore large materials spaces cheaply  

---

## Types of ML Surrogates

### Property Surrogates
- Predict scalar properties directly:
  - Formation energy  
  - Band gap  
  - Elastic moduli  
- Input: composition, structure descriptors, graphs  
- Output: property  

Examples:
- Magpie + Random Forest for formation energies  
- CGCNN / MEGNet for energies & band gaps  

---

### Interatomic Potentials / Force Fields

- ML models that approximate:
  - Energies & forces for arbitrary atomic configurations  
- Used for:
  - Large-scale MD simulations  
  - Defects & surfaces  
  - Long timescales  

Inputs:
- Local environment descriptors (SOAP, symmetry functions, graphs…)  
Outputs:
- Local energies, forces  

---

## Why Surrogates Matter in Materials Genomics

- Enable exploration of huge combinatorial spaces  
- Detect promising candidates without full DFT  
- Allow more realistic simulation scales (size/time)  
- Combine with active learning & closed-loop experiments  

DFT becomes:
- Data source  
ML becomes:
- Efficient approximation & generalization layer  

---

## 6. Exercise: Toy DFT Calculation (Conceptual)

**Goal:**  
Give students a concrete feel for DFT workflows, even if only at a high level.

Options:
- Run a simple Quantum ESPRESSO calculation  
- Or use Materials Project / MPComplete example workflows conceptually  

---

## Step 1 — Choose a Toy System

Example materials:
- Silicon (diamond structure)  
- NaCl (rocksalt)  
- Al (fcc metal)  

Small unit cell:
- Few atoms → cheap DFT  
- Clear band structure  

---

## Step 2 — Input Files

For Quantum ESPRESSO:
- `pw.x` input file requires:
  - &control (calculation type, I/O)  
  - &system (ecutwfc, ecutrho, occupations, nat, ntyp)  
  - &electrons (SCF convergence parameters)  
  - ATOMIC_SPECIES  
  - ATOMIC_POSITIONS (crystal or angstrom)  
  - K_POINTS  

**PYTHONHERE**  
(placeholder: pseudo-generation/parsing of input)  

---

## Step 3 — Run a Self-Consistent Field (SCF) Calculation

Concept (students do not need to see real command):

- Command line:  
  `pw.x < scf.in > scf.out`  

Outputs:
- Ground-state energy  
- Electron density  
- Basic band information  

---

## Step 4 — Band Structure (Optional)

To compute band structure:
1. Use SCF charge density as reference  
2. Run a non-SCF (`nscf`) calculation along high-symmetry k-path  
3. Extract eigenvalues vs k  

Students should understand:
- SCF: find self-consistent density  
- Non-SCF: reuse density to compute bands along chosen k-path  

---

## Step 5 — From Raw Output to Usable Data

Extract:
- Total energy → reference for formation energy  
- Lattice parameters & relaxed positions  
- Band structure plot (visual)  
- Possibly DOS  

Then:
- Discuss how this single data point would enter a database (Materials Project-like)  
- Link it to descriptors & ML surrogates from previous weeks  

---

## Alternative: Materials Project Workflow (Conceptual)

If running DFT locally is too much:

1. Show how MP (or similar) uses workflows:
   - Structure relaxation  
   - Static calculation  
   - Band structure  
   - Elastic tensor  

2. Explain:
   - Consistency of parameters  
   - High-throughput automation  
   - Data curation  

Students see:
- That each MP entry corresponds to a **standardized DFT workflow**  

---

## 7. Summary

**Today you learned:**
- DFT is the core QM engine in Materials Genomics  
- It provides energies, forces, band structures, elastic constants, and more  
- DFT is accurate but computationally expensive  
- ML surrogates approximate DFT and scale to large materials spaces  
- Toy DFT calculations help connect theory to actual workflows  

Next week:  
**Week 8 — From DFT Data to ML Property Models**  
(Training regressors on DFT data, validation, and limitations.)

---

## Questions?

Use the chalkboard!



<div>
<script>
document.getElementById("marimo-frame").onload = function() {
    try {
        let iframeDoc = document.getElementById("marimo-frame").contentWindow.document;
        let marimoBadge = iframeDoc.querySelector("div.fixed.bottom-0.right-0.z-50");
        if (marimoBadge) {
            marimoBadge.style.display = "none";
            console.log("Marimo badge hidden successfully.");
        } else {
            console.log("Badge not found.");
        }
    } catch (error) {
        console.warn("Unable to modify iframe content due to CORS restrictions.");
    }
};
</script>
</div>