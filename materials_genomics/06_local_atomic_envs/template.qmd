---
title: |
  Materials Genomics<br>
  Lecture 6: Local Atomic Environments
bibliography: ref.bib
# csl: custom.csl
author:
  - name: Prof. Dr. Philipp Pelz
    affiliation: 
      - FAU Erlangen-Nürnberg
      - Institute of Micro- and Nanostructure Research
   
execute: 
  eval: true
  echo: true
format: 
    revealjs: 
        chalkboard: true
        mermaid:
            theme: forest
        # mermaid-format: png
        # scroll-view:
        #     activate: true
        #     snap: mandatory
        #     layout: full 
        width: 1920
        height: 1080
        menu:
            side: right
            width: wide 
        template-partials:
            - title-slide.html
        css: custom.css
        theme: custom.scss
        slide-number: c/t    
        logo: "eclipse_logo_small.png"          
        highlight-style: a11y
        incremental: true 
        background-transition: fade
        footer: "©Philipp Pelz - FAU Erlangen-Nürnberg - Materials Genomics"
---
 

## Welcome

### Week 6 — Local Atomic Environments

**Goals for today:**

- Understand local atomic environments as the “atoms of structure”  
- Learn Voronoi tessellations & coordination numbers  
- Learn what SOAP (Smooth Overlap of Atomic Positions) descriptors are  
- See how these feed ML interatomic potentials and force fields  
- Conceptually compute SOAP vectors and cluster them  

---

## Outline

1. Why local atomic environments?  
2. Voronoi tessellations & coordination numbers  
3. SOAP descriptors  
4. Local environments in ML interatomic potentials  
5. Exercise: SOAP + clustering (conceptual)  
6. Summary  

---

## 1. Why Local Atomic Environments?

Global structure is:

- Huge  
- Periodic  
- Hard to compare directly  

Local atomic environment:

- The neighborhood of one atom  
- Captures local bonding & geometry  
- Often sufficient to define:
  - Bond strengths  
  - Local energies  
  - Diffusion barriers  
  - Defect cores  

In many models:
**Energy = sum of local atomic contributions**  
So representing local environments is central to ML potentials.

---

## Local Environments as “Structural Words”

Think of a crystal as:

- A “sentence” made of repeated “words” (local environments)  

Examples:

- Tetrahedral vs octahedral coordination  
- Distorted octahedra in perovskites  
- Coordination changes around defects or surfaces  

Descriptors like SOAP are how we represent these “words” numerically.

---

## 2. Voronoi Tessellations & Coordination Numbers

### Voronoi Tessellation

Given a set of atoms:

- Each atom owns a region of space closer to it than to any other atom  
- Space is partitioned into **Voronoi cells**  
- Voronoi cell shape reflects local packing and neighbors  

Used to determine:

- Nearest neighbors  
- Coordination numbers  
- Solid angle weights  

---

## Coordination Numbers

Coordination number (CN):

- Number of neighboring atoms around a central atom  

Classical definition:

- Count atoms within a cutoff radius  

Voronoi-based CN:

- Use shared faces between Voronoi cells  
- Each neighbor receives weight proportional to shared face area  
- More robust than simple distance cutoffs  

---

## Why Voronoi & CN Matter

They provide:

- Simple but powerful local descriptors  
- Inputs to more complex descriptors (SOAP, ACSF, etc.)  
- Features for:
  - Phase classification  
  - Defect identification  
  - Structural transitions  

They’re often the **first step** in local environment analysis.

---

## 3. SOAP Descriptors

SOAP = **Smooth Overlap of Atomic Positions**

Goal:
- Represent a local atomic neighborhood as a rotation-invariant, permutation-invariant vector  
- Sensitive to detailed geometric arrangement  

---

## SOAP: Conceptual Steps

1. Choose a **central atom**  
2. Define a cutoff radius \(r_c\)  
3. Place a **Gaussian density** at each neighbor within \(r_c\)  
4. Expand this neighbor density in:
   - Radial basis functions  
   - Spherical harmonics (for angular information)  
5. Compute rotationally invariant combinations of expansion coefficients  

Result:

- A high-dimensional feature vector describing the local environment  

---

## Why SOAP Is Great

SOAP:

- Is continuous and smooth w.r.t atomic positions  
- Invariant to:
  - Rotation  
  - Permutation of neighbors  
  - Global translation  
- Sensitive to:
  - Coordination geometry  
  - Bond lengths & angles  
  - Structural distortions  

Heavily used in:

- Gaussian Approximation Potentials (GAP)  
- Kernel-based ML potentials  
- Similarity metrics between structures  

---

## SOAP as a Local Fingerprint

SOAP vector encodes:

- “Is this environment tetrahedral or octahedral?”  
- “How distorted is the octahedron?”  
- “Is this site bulk-like, surface-like, or defective?”  

Comparing SOAP vectors:

- Small distance → similar environments  
- Large distance → different environments  

Enables:

- Clustering  
- Dimensionality reduction  
- Local structure classification  

---

## 4. Local Environments in ML Interatomic Potentials

Many ML potentials approximate total energy as:

\[
E_{\text{total}} = \sum_i E_i(\text{local environment of atom } i)
\]

Where:
- Each \(E_i\) is modeled by ML  
- Input: descriptor of local environment (e.g., SOAP)  

---

## Examples of ML Potentials

### GAP (Gaussian Approximation Potentials)
- Use SOAP as descriptor  
- Use Gaussian Process regression  
- Learn mapping: SOAP → local energy  

### Behler–Parrinello Neural Network Potentials
- Use symmetry functions as local descriptors  
- NN maps them to atomic energies  

### Other GNN/LAN-type models
- Use graph-based local neighborhood  
- Message passing constructs learned local descriptors  

SOAP & related descriptors:
- Bridge physics (local environments) and ML (vectors).

---

## Why Local Environments Are Key

Properties dependent on local environments:

- Elastic response  
- Phase stability  
- Diffusion barriers  
- Defect formation energies  

ML potentials rely on:

- Accurate representation of these environments  
- Good coverage of environment types in training data  

SOAP provides:

- A flexible and expressive representation  
- Good notion of local similarity  

---

## 5. Exercise: SOAP Vectors & Clustering (Conceptual)

Goal:

- Compute SOAP descriptors for local environments  
- Cluster them in descriptor space  
- Interpret the clusters physically  

---

## Step 1 — Choose System & Environments

Example:

- Silicon: bulk + surface + defect  
- Perovskite: A-site vs B-site vs O-site environments  
- Metallic alloy: environments in different phases  

For each atomic environment:

- Define central atom  
- Determine neighbors within cutoff  

---

## Step 2 — Compute SOAP Descriptors

Using a SOAP implementation (e.g., DScribe, QUIP, etc.):

Conceptual steps (no real code):

**PYTHONHERE**

Operations:
- Define SOAP parameters:
  - Cutoff radius  
  - Radial basis size  
  - Angular expansion (l_max)  
- Generate SOAP vector for each local environment  

Result:
- Matrix of descriptors:
  \[
  X \in \mathbb{R}^{N \times d_{\text{SOAP}}}
  \]

---

## Step 3 — Dimensionality Reduction (Optional)

SOAP vectors are high-dimensional. Reduce dimensionality for visualization:

- PCA  
- t-SNE  
- UMAP  

**PYTHONHERE**

Outcome:
- 2D or 3D representation of local environment space  

---

## Step 4 — Clustering

Cluster SOAP vectors (or reduced embeddings):

Algorithms:
- k-Means  
- Agglomerative clustering  
- DBSCAN  

**PYTHONHERE**

Interpretation:
- Each cluster corresponds to a type of local environment  
- Example:
  - Cluster 1 → ideal bulk environments  
  - Cluster 2 → surface-like environments  
  - Cluster 3 → defect core environments  

---

## Step 5 — Physical Interpretation

Ask:

- Do clusters align with known coordination types?  
- Are distorted environments separating from ideal ones?  
- Can you identify which cluster corresponds to which site (A vs B vs O)?  

Objective:

- Show students that **local environment space** has structure  
- SOAP provides a way to navigate it  

---

## 6. Summary

**Today you learned:**

- Local atomic environments are building blocks of materials structure  
- Voronoi tessellations & coordination numbers describe local neighborhoods  
- SOAP descriptors provide a smooth, symmetry-respecting fingerprint  
- ML interatomic potentials rely on local environment descriptors  
- Clustering SOAP vectors reveals families of local environments  

Next week:  

**Week 7 — DFT Databases & Property Prediction Pipelines**  
(Bridging local environment descriptors with QM-calculated properties.)

---

## Questions?

Use the chalkboard!

<div>
<script>
document.getElementById("marimo-frame").onload = function() {
    try {
        let iframeDoc = document.getElementById("marimo-frame").contentWindow.document;
        let marimoBadge = iframeDoc.querySelector("div.fixed.bottom-0.right-0.z-50");
        if (marimoBadge) {
            marimoBadge.style.display = "none";
            console.log("Marimo badge hidden successfully.");
        } else {
            console.log("Badge not found.");
        }
    } catch (error) {
        console.warn("Unable to modify iframe content due to CORS restrictions.");
    }
};
</script>
</div>