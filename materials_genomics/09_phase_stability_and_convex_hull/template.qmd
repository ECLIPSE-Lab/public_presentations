---
title: |
  Materials Genomics<br>
  Lecture 9: Phase Stability & the Convex Hull
bibliography: ref.bib
# csl: custom.csl
author:
  - name: Prof. Dr. Philipp Pelz
    affiliation: 
      - FAU Erlangen-Nürnberg
      - Institute of Micro- and Nanostructure Research
   
execute: 
  eval: true
  echo: true
format: 
    revealjs: 
        chalkboard: true
        mermaid:
            theme: forest
        # mermaid-format: png
        # scroll-view:
        #     activate: true
        #     snap: mandatory
        #     layout: full 
        width: 1920
        height: 1080
        menu:
            side: right
            width: wide 
        template-partials:
            - title-slide.html
        css: custom.css
        theme: custom.scss
        slide-number: c/t    
        logo: "eclipse_logo_small.png"          
        highlight-style: a11y
        incremental: true 
        background-transition: fade
        footer: "©Philipp Pelz - FAU Erlangen-Nürnberg - Materials Genomics"
---
  

## Welcome

### Week 9 — Phase Stability & the Convex Hull

**Goals for today:**

- Deepen understanding of formation energy and stability  
- Understand metastability and energy above hull  
- Learn how to map an entire chemical system using convex hulls  
- Conceptually reconstruct phase diagrams from Materials Project data  

---

## Outline

1. Formation energy recap  
2. Metastability & hull distance  
3. Convex hull construction in composition space  
4. Mapping an entire chemical system  
5. Exercise: phase diagrams from Materials Project data  
6. Summary  

---

## 1. Formation Energy Recap

Formation energy per atom:

\[
E_f = E_{\text{compound}} - \sum_i x_i \mu_i
\]

Where:
- \(E_{\text{compound}}\): energy per atom of the compound  
- \(x_i\): atomic fraction of element \(i\)  
- \(\mu_i\): reference energy per atom of element \(i\) (e.g. ground-state crystal or molecule)  

Interpretation:
- Negative \(E_f\) → stable relative to separated elements  
- More negative → more energetically favorable formation  

---

## Why Formation Energy Alone Is Not Enough

Consider:

- Several compounds with similar compositions  
- All have negative formation energies  

Question:

- Which one actually appears in equilibrium?  

Answer:

- You must consider **competition between phases**  
- That’s what the **convex hull** encodes  

---

## 2. Metastability & Energy Above Hull

Energy above hull:

\[
E_{\text{hull}} = E_f(\text{material}) - E_f(\text{stable combination at same composition})
\]

Interpretation:
- \(E_{\text{hull}} = 0\) → thermodynamically stable  
- Small positive \(E_{\text{hull}}\) → metastable  
- Large positive \(E_{\text{hull}}\) → unstable  

---

## Metastability Window

Empirical rules of thumb:

- \(\leq 20\) meV/atom → often synthesizable  
- 20–50 meV/atom → metastable, may require special routes  
- > 100 meV/atom → usually not observed in bulk form  

Metastability arises from:

- Kinetic barriers  
- Non-equilibrium synthesis routes  
- Finite-temperature entropic effects not captured by 0 K DFT  

---

## Why Hull Distance Matters

Uses:

- Filter candidate materials by synthesizability  
- Rank materials in terms of stability risk  
- Understand phase competition in multi-component systems  
- Drive ML models (predict hull distance directly)  

---

## 3. Convex Hull Construction (Conceptual)

The convex hull is the **lower envelope** of formation energies across composition space.

### For a binary A–B system:

- x-axis: composition \(x_B\)  
- y-axis: formation energy per atom  

Steps:
1. Plot all computed \(E_f\) points  
2. Compute the convex hull: minimal piecewise linear curve that lies below all points  
3. Points on the hull → stable phases  
4. Points above hull → metastable/unstable  

---

## Geometry of the Hull

Interpretation for a point above the hull:

- Draw a line between two (or more) hull phases that intersect at same composition  
- Vertical distance between the point and the hull line = \(E_{\text{hull}}\)  

The hull encodes:

- Equilibrium phase mixture at each composition  
- Decomposition pathway: which phases the material breaks into  

---

## Ternary and Higher Systems

Ternary A–B–C:

- Composition space → triangle (simplex)  
- Each vertex: pure element  
- Points inside: mixtures of A, B, C  
- Convex hull → lower 2D surface in 3D plot (composition + energy)  

In practice:

- Hard to visualize beyond 3 components  
- But same concept applies in higher dimensions  

---

## 4. Mapping an Entire Chemical System

Goal:

- From many DFT energies → full phase diagram  

Given:

- All known / enumerated phases in A–B–C… system  
- Their formation energies  

Steps:

1. Build convex hull in composition–energy space  
2. Identify stable phases (on hull)  
3. Determine tie-lines / tie-planes between stable phases  
4. Construct phase diagram slices:
   - Binary (A–B, A–C, B–C)  
   - Ternary (A–B–C triangle)  

---

## Phase Diagram Features

From the convex hull, you can derive:
- Stable phases at each composition  
- Coexistence of phases (two-phase or three-phase regions)  
- Decomposition products of any metastable phase  

Example questions:

- “At composition \(x\), which phases coexist at equilibrium?”  
- “Which mixture minimizes the total formation energy?”  

All answerable from the hull.

---

## Temperature & Entropy (Conceptual)

The convex hull as usually computed:

- Uses 0 K DFT energies  
- Ignores vibrational and configurational entropy  

At finite temperatures:

- Free energy \(G = H - TS\) matters  
- Entropy can stabilize additional phases  
- Phase diagrams become temperature-dependent  

But:

- 0 K hull is still an excellent first approximation  
- Widely used for high-throughput screening  

---

## 5. Exercise: Reconstruct Phase Diagrams from Materials Project Data

Goal:

- Use Materials Project (or conceptually simulated data) to reconstruct a phase diagram and hull.  

This is mostly conceptual in class; coding details can go to a notebook.

---

## Step 1 — Query Data for a Chemical System

Choose a binary or ternary system:

- Binary: Li–Fe, Mg–O, Al–O  
- Ternary: Li–Fe–O, Ca–Ti–O  

From Materials Project, query:

- All entries for that system  
- Get composition and formation energy per atom  
- Get MP’s reported energy above hull (for validation)  

Conceptual data format:

- `formula`, `composition`, `formation_energy_per_atom`, `e_above_hull`  

**PYTHONHERE**

(Placeholder to signal query & data collection.)

---

## Step 2 — Compute the Convex Hull Yourself

Conceptually:

1. For each entry, represent composition in barycentric coordinates (fractions of each element).  
2. Use a convex hull algorithm (e.g., `scipy.spatial.ConvexHull`) on the points in composition–energy space.  
3. Identify which points lie on the lower hull.  
4. Compute energy above hull for each entry.  

**PYTHONHERE**

No real code here in slides, just the logic.

---

## Step 3 — Plot & Compare to MP

For a binary system:

- Plot \(E_f\) vs composition  
- Mark hull points  
- Draw hull segments  

Compare:

- Your computed hull distances vs MP’s `e_above_hull`  
- They should largely agree (modulo choices of references and rounding).  

This reinforces:

- Understanding of hull geometry  
- Trust in database stability metrics  

---

## Step 4 — Build a Simple Phase Diagram

Using the hull information:

- Identify stable phases (on hull)  
- Connect them with tie-lines  
- For ternary:
  - Plot in 2D compositional triangle, color code stable phases  

Conceptual visualization:

- Regions assigned to different phase mixtures  
- Students recognize typical phase diagram patterns  

**PYTHONHERE**

---

## Step 5 — Interpretation

Ask students:

- Which phases are thermodynamically stable?  
- Which materials are metastable but close to hull (promising candidates)?  
- How could you decide which compounds to target experimentally?  
- How would finite temperature shift this picture qualitatively?  

This connects:

- Raw DFT data → convex hull → phase diagram → synthesis decisions  

---

## 6. Summary

**Today you learned:**

- Formation energies encode stability relative to elements  
- Energy above hull quantifies metastability  
- The convex hull is the central tool for phase stability analysis  
- Mapping an entire chemical system means constructing the hull in composition space  
- Materials Project and similar databases provide hull-derived stability metrics  
- You can reconstruct phase diagrams using hull computations  

Next week:  

**Week 10 — Uncertainty & Probabilistic Models in Materials Genomics**  
(How to quantify confidence in predictions, and use it for design.)

---

## Questions?

Use the chalkboard!

<div>
<script>
document.getElementById("marimo-frame").onload = function() {
    try {
        let iframeDoc = document.getElementById("marimo-frame").contentWindow.document;
        let marimoBadge = iframeDoc.querySelector("div.fixed.bottom-0.right-0.z-50");
        if (marimoBadge) {
            marimoBadge.style.display = "none";
            console.log("Marimo badge hidden successfully.");
        } else {
            console.log("Badge not found.");
        }
    } catch (error) {
        console.warn("Unable to modify iframe content due to CORS restrictions.");
    }
};
</script>
</div>