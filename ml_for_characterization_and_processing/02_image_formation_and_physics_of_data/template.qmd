---
title: |
  ML for Characterization and Processing<br>
  Lecture 2: Image Formation & the Physics of Data
bibliography: ref.bib
# csl: custom.csl
author:
  - name: Prof. Dr. Philipp Pelz
    affiliation: 
      - FAU Erlangen-Nürnberg
      - Institute of Micro- and Nanostructure Research
   
execute: 
  eval: true
  echo: true
format: 
    revealjs: 
        chalkboard: true
        mermaid:
            theme: forest
        # mermaid-format: png
        # scroll-view:
        #     activate: true
        #     snap: mandatory
        #     layout: full 
        width: 1920
        height: 1080
        menu:
            side: right
            width: wide 
        template-partials:
            - title-slide.html
        css: custom.css
        theme: custom.scss
        slide-number: c/t    
        logo: "eclipse_logo_small.png"          
        highlight-style: a11y
        incremental: true 
        background-transition: fade
        footer: "©Philipp Pelz - FAU Erlangen-Nürnberg - ML for Characterization and Processing"
---
     
  
## Welcome

### Week 2 — Image Formation & the Physics of Data

**Goals for today:**
- Understand how characterization techniques *create* images  
- Learn Fourier optics intuition for ML  
- Connect sampling, aliasing, and noise to ML limitations  
- Practice Fourier & wavelet inspection in a mini-lab  

---

## Outline

1. Image formation across modalities  
2. Fourier optics intuition  
3. Sampling, aliasing, denoising  
4. Lab: Fourier & wavelet analysis  
5. Summary  

---

## 1. How Characterization Creates Data

### Images are *physical measurements*, not generic pictures.

Different modalities → different physics → different ML constraints.

We explore:

- Optical microscopy  
- SEM  
- TEM  
- EBSD (brief)  
- Spectral imaging links (EDS/EELS)  

---

## Optical Microscopy

- Illumination → objective → sensor  
- Resolution is **diffraction-limited**  
- Abbe limit:  
  \[
  d \approx \frac{0.61\lambda}{\mathrm{NA}}
  \]

Contrast mechanisms:
- Bright-field  
- Dark-field  
- Phase contrast / DIC  

**ML relevance:**  
Low-frequency dominated images → easy for CNNs but limited structural detail.

---

## SEM Image Formation

### What creates contrast?
- **Secondary electrons (SE):** topography  
- **Backscattered electrons (BSE):** atomic number  
- **Edge effects:** orientation dependence  

### Artifacts:
- Charging  
- Drift  
- Astigmatism  
- Contamination  

**ML implications:**  
Domain shift between instruments is large.  
Artifacts look like "features" to naïve models.

---

## TEM Image Formation

### TEM contrast mechanisms
- Mass–thickness contrast  
- Diffraction contrast  
- Phase contrast (high-resolution TEM)

### Key idea:
The TEM image is a **filtered Fourier transform** of the exit wave.

- Phase object approximation  
- Cs, defocus → contrast transfer function (CTF)

**ML relevance:**  
CTF acts as a frequency-dependent filter → missing information must be learned or reconstructed.

---

## EBSD (Brief)

- Kikuchi patterns form from electron channeling + diffraction  
- Orientation is inferred, not directly observed  
- Noise leads to misindexing  
- Grain boundaries arise as misorientation fields

**ML challenges:**  
Orientation data live on SO(3), not Euclidean space.

---

## Summary Table

| Modality | Resolution | Contrast | Artifacts | ML Challenges |
|---------|------------|----------|-----------|---------------|
| Optical | ~200 nm | Absorption/phase | Blur, noise | Low detail |
| SEM | 1–10 nm | SE/BSE | Charging, drift | Domain shift |
| TEM | sub-Å | Phase, diffraction | CTF effects | Missing frequencies |
| EBSD | ~50 nm | Kikuchi patterns | Misindexing | Orientation math |

---

## 2. Fourier Optics Intuition

### Students already know:
- Fourier transforms  
- Convolutions  
- Frequency filtering  

Today: apply that to **microscope physics**.

---

## Image = Convolution with PSF

Every imaging system produces:

\[
I(x,y) = (O * \text{PSF})(x,y)
\]

Fourier domain:

\[
\mathcal{F}\{I\} = \mathcal{F}\{O\} \cdot \text{OTF}
\]

- PSF = point spread function  
- OTF = optical transfer function  
- MTF = magnitude of OTF  

---

## NA, Wavelength & Resolution

- High NA → wider spatial-frequency passband  
- Shorter wavelength (electrons) → enormous bandwidth  
- Coherence affects contrast mechanisms  

**But:** Aberrations limit usable bandwidth → CTF oscillates.

---

## TEM Contrast Transfer Function (CTF)

An intuitive view:

- Microscope phase shifts modulate Fourier components  
- CTF flips signs → contrast inversions  
- Zeros → missing frequencies  

**ML relevance:**  
The model cannot “see” frequencies that are not transferred.  
A network is fundamentally limited by physics.

---

## Fourier View of Microstructure

Image information sits in specific frequency bands:

- Grain boundaries → mid frequencies  
- Phase textures → broad frequency ranges  
- Precipitates → high frequencies  
- Noise → very high frequencies  

ML filters replicate these patterns.

---

## 3. Sampling, Aliasing & Denoising

### 3.1 Spatial Sampling

Pixel size dictates sampling, not resolution.

- Camera sampling rate ↔ Nyquist frequency  
- Undersampling collapses high frequencies → fake features  

---

## Detector Considerations

- Read noise  
- Dark current  
- Pixel cross-talk  
- Electron counting statistics (Poisson noise)

### Poisson SNR increases as:
\[
\text{SNR} \propto \sqrt{N\_\text{electrons}}
\]

Low-dose imaging → low SNR → ML denoising required.

---

## Aliasing

When sampling < required Nyquist:

- High frequencies fold back  
- Creates artificial fringes  
- Especially common in STEM/4D-STEM if binning is too aggressive  

**Takeaway:** ML cannot distinguish real structure from aliasing without physics priors.

---

## Denoising = Prior Knowledge

### Types of priors:
- Smoothness → Gaussian filters  
- Sparsity → wavelet shrinkage  
- Low-rank → PCA/NMF  
- Edge-preserving → Total Variation  

**ML denoising** learns priors implicitly  
→ Noise2Noise, Noise2Void, self-supervised approaches

---

## 4. Lab: Fourier & Wavelet Inspection

### Students use:
- SEM image  
- TEM image  
- Optical micrograph  

---

### Lab A: Fourier Transform
<!-- ```{python}
import numpy as np
import matplotlib.pyplot as plt
from skimage import io

img = io.imread("sem_example.png", as_gray=True)
F = np.fft.fftshift(np.fft.fft2(img))

plt.figure(figsize=(6,6))
plt.imshow(np.log(np.abs(F)+1), cmap='magma')
plt.title("Fourier Spectrum")
plt.axis("off")
``` -->

### Lab B: Wavelet Decomposition
<!--  ```{python}
import pywt
import matplotlib.pyplot as plt

coeffs = pywt.wavedec2(img, 'db2', level=3)
pywt.imshow(coeffs, title="Wavelet Decomposition")
``` -->

Tasks:

Identify noise-dominated scales

Locate microstructural features

Relate frequency bands to physical features

### Lab C: Aliasing Demo
<!-- ```{python}
import numpy as np
import matplotlib.pyplot as plt
from skimage import io

img = io.imread("sem_example.png", as_gray=True)
img2 = img[::2, ::2]
img4 = img[::4, ::4]
``` -->


Visualize Fourier spectra of each.

Tasks:

Observe high-frequency folding

Discuss implications for ML

### 5. Summary

Key insights:

Imaging systems filter physical fields

Fourier-domain reasoning is essential for ML in characterization

Sampling, aliasing, and noise limit what ML can learn

Denoising & reconstruction depend on priors

Fourier & wavelets offer tools for understanding structure

Next week:
- Data Quality & ML-Readiness
<div>
<script>



document.getElementById("marimo-frame").onload = function() {
    try {
        let iframeDoc = document.getElementById("marimo-frame").contentWindow.document;
        let marimoBadge = iframeDoc.querySelector("div.fixed.bottom-0.right-0.z-50");
        if (marimoBadge) {
            marimoBadge.style.display = "none";
            console.log("Marimo badge hidden successfully.");
        } else {
            console.log("Badge not found.");
        }
    } catch (error) {
        console.warn("Unable to modify iframe content due to CORS restrictions.");
    }
};
</script>
</div>