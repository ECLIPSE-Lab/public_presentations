---
title: |
  ML for Characterization and Processing<br>
  Lecture 10: Spectral data: ML for XRD, EELS, EDS
bibliography: ref.bib
# csl: custom.csl
author:
  - name: Prof. Dr. Philipp Pelz
    affiliation: 
      - FAU Erlangen-Nürnberg
      - Institute of Micro- and Nanostructure Research
   
execute: 
  eval: true
  echo: true
format: 
    revealjs: 
        chalkboard: true
        mermaid:
            theme: forest
        # mermaid-format: png
        # scroll-view:
        #     activate: true
        #     snap: mandatory
        #     layout: full 
        width: 1920
        height: 1080
        menu:
            side: right
            width: wide 
        template-partials:
            - title-slide.html
        css: custom.css
        theme: custom.scss
        slide-number: c/t    
        logo: "eclipse_logo_small.png"          
        highlight-style: a11y
        incremental: true 
        background-transition: fade
        footer: "©Philipp Pelz - FAU Erlangen-Nürnberg - ML for Characterization and Processing"
---
 
 

## Welcome

### Week 10 — Spectral Data: ML for XRD, EELS, EDS

**Goals for today:**

- Understand spectral data fundamentals  
- Learn about noise, background, and artifacts  
- Apply ML techniques: denoising, peak detection, background removal  
- Explore dimensionality reduction (PCA, NMF, ICA)  
- Build full spectral ML pipelines  

---

## Outline

1. What spectral data represent  
2. Noise & background  
3. ML preprocessing: denoising, peaks, background  
4. Dimensionality reduction (PCA, NMF, ICA)  
5. Spectral ML workflows  
6. Summary  

---

## 1. What Spectral Data Represent

### XRD
- Peaks → crystallographic planes  
- Peak width → grain size, strain  
- Peak shifts → lattice parameter changes  
- Intensities → texture, phase fraction  

---

### EELS
- Ionization edges → element + bonding  
- ELNES → coordination, oxidation state  
- Plasmons → electron density  
- Multiple scattering → distortions of shape  

---

### EDS
- Peaks → elemental energy levels  
- Overlaps → deconvolution challenge  
- Background → Bremsstrahlung + detector scatter  

---

## Why ML for Spectra?

High-dimensional signals, but:
- Noisy  
- Overlapping features  
- Complex backgrounds  
- Instrument drift  

ML + signal processing helps us extract:
- Peak positions  
- Features  
- Latent components  
- Trends across temperature / time / composition  

---

## 2. Noise & Background

### Sources of noise
- Poisson counting noise (EELS, EDS)  
- Readout noise  
- Dark current  
- Beam fluctuations  
- Photon flux variation (XRD)  

---

### Background components
- XRD: amorphous halo, air scatter  
- EELS: power-law tail, plural scattering  
- EDS: Bremsstrahlung continuum  

---

### Instrument artifacts
- Energy drift  
- Channel misalignment  
- Nonlinear detector response  

**→ Essential to clean spectra before ML.**

---

## 3. ML Preprocessing: Denoising, Peaks, Background

### 3.1 Denoising

Methods:
- Gaussian smoothing  
- Savitzky–Golay filters  
- Wavelet denoising  
- PCA denoising  
- Autoencoder denoising (conceptually)

**PYTHONHERE**

(Small example placeholder for denoising workflow)

---

### When to use which?

Savitzky–Golay → preserves peak shape  
Wavelets → preserves edges (great for EELS)  
PCA → excellent for hyperspectral denoising  
Autoencoders → for irregular backgrounds  

---

## 3.2 Peak Detection

Tasks:
- Locate peaks  
- Estimate FWHM  
- Deconvolve overlapping peaks  
- Track shifts in temperature/time series  

Methods:
- First derivative threshold  
- Second derivative zero-crossing  
- Template matching  
- Gaussian/Lorentzian fitting  
- ML models for noisy signals  

---

## 3.3 Background Removal

### XRD
- Polynomial background removal  
- SNIP algorithm  
- Rolling-ball & rolling-quantile filters  

### EELS
- Power-law background  
- Fourier-ratio deconvolution (plural scattering)  
- Parametric models  

### EDS
- Bremsstrahlung background fit  
- Peak decomposition models  

Background removal isolates *physics*, not noise.

---

## 3.4 Feature Extraction

Extract meaningful values:
- Peak positions & heights  
- Integrated peak areas  
- Peak shape descriptors  
- Edge onset (EELS)  
- White-line ratios (L2/L3)  
- Plasmon energies  
- XRD peak broadening (grain size, microstrain)  

These feed into ML models downstream.

---

## 4. Dimensionality Reduction

Spectral datasets:
- XRD scans across temperature  
- EELS/EDS spectrum images  
- Time series of spectra during reactions  
- High-dimensional composition libraries  

Use dimensionality reduction to extract latent structure.

---

## 4.1 PCA (Principal Component Analysis)

PCA finds orthogonal directions of maximum variance.

Good for:

- Denoising  
- Trend detection  
- Peak shift analysis  
- Compressing hyperspectral cubes  

Physically:

- Components often correspond to “broad changes,” not specific phases.

---

## 4.2 NMF (Non-negative Matrix Factorization)

NMF decomposes spectra into:

- Non-negative basis spectra  
- Abundance maps  

Perfect for:

- EELS & EDS mapping  
- XRD phase decomposition  
- Chemical/morphological mapping  

Non-negativity → physically interpretable.

---

## 4.3 ICA (Independent Component Analysis)

ICA extracts statistically **independent** sources.

Useful for:

- Overlapping peaks from different elements  
- Mixed EELS signals  
- Phases with uncorrelated spectral signatures  

Limitations:

- Noise sensitive  
- Assumes independence  

---

## 4.4 Summary: PCA vs NMF vs ICA

| Method | Good for | Weakness |
|--------|----------|----------|
| **PCA** | Denoising, dimensionality reduction | Components mixed; can be negative |
| **NMF** | Physical basis spectra & phase maps | Non-unique; needs good init |
| **ICA** | Blind separation of independent signals | Noise-sensitive; independence required |

---

## 5. Spectral ML Workflows

### Typical workflow:

1. Acquire raw spectra  
2. Correct drift + gain  
3. Denoise  
4. Remove background  
5. Detect peaks or edges  
6. Extract features OR run dimensionality reduction  
7. Feed into ML model (classify, regress, cluster)  

---

### Example Applications

- Predict phase fraction from XRD  
- Predict oxidation state from EELS edges  
- NMF mapping for chemical phases  
- PCA or ICA for peak separation  
- Clustering EDS maps into phases  

**PYTHONHERE**

(Placeholder for PCA/NMF processing demo)

---

### Connection to Materials Genomics

Spectra often provide:

- Composition features  
- Structural fingerprints  
- Local chemical environment  
These feed into surrogate models from the other course.

---

## 6. Summary

### Key insights:
- XRD, EELS, EDS provide rich but noisy high-dimensional spectra  
- Preprocessing is essential: denoise → subtract background → detect peaks  
- Dimensionality reduction (PCA, NMF, ICA) reveals underlying structure  
- NMF gives physically interpretable components  
- Spectral ML is central to phase identification and chemical analysis  

Next week:  
**Week 11 — ML for Diffraction-Based Imaging & 4D-STEM**

---

## Questions?

Use the chalkboard!


<div>
<script>
document.getElementById("marimo-frame").onload = function() {
    try {
        let iframeDoc = document.getElementById("marimo-frame").contentWindow.document;
        let marimoBadge = iframeDoc.querySelector("div.fixed.bottom-0.right-0.z-50");
        if (marimoBadge) {
            marimoBadge.style.display = "none";
            console.log("Marimo badge hidden successfully.");
        } else {
            console.log("Badge not found.");
        }
    } catch (error) {
        console.warn("Unable to modify iframe content due to CORS restrictions.");
    }
};
</script>
</div>